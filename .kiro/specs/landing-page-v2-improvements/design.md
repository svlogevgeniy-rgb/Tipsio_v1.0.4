# Документ дизайна

## Обзор

Этот документ описывает обновления лендинга TIPSIO для репозиционирования платформы как "платформы гостевого опыта". Изменения включают обновление hero-текста, удаление устаревших преимуществ, унификацию стилей кнопок и замену hero-изображения на современный визуал в стиле shadcn/ui.

Приложение использует Next.js 14 с App Router, TypeScript, Tailwind CSS и систему i18n для локализации. Дизайн использует существующую инфраструктуру shadcn/ui без введения новых зависимостей.

## Архитектура

### Задача 1: Обновление Hero-текста

**Текущее состояние:**
- Hero-текст хранится в файлах переводов `messages/ru.json` и `messages/en.json`
- Ключи: `landingV3.hero.subheadline`, `landingV3.hero.trust1`, `landingV3.hero.trust2`
- Компонент: `src/components/landing/main/sections/LandingHeroSection.tsx`

**Целевое состояние:**
- Новый текст: "Цифровая платформа гостевого опыта, в которой люди работают с людьми."
- Подзаголовок: "Бесплатное подключение. Гостям вашего заведения будет удобнее, а персоналу — проще."
- Неразрывные пробелы в ключевых местах

**Затрагиваемые файлы:**
- `messages/ru.json` - русские переводы
- `messages/en.json` - английские переводы (эквивалентный текст)

### Задача 2: Удаление устаревших преимуществ

**Текущее состояние:**
- Trust-пункты отображаются в hero-секции через ключи `hero.trust1` и `hero.trust2`
- Текущие значения: "Прямые выплаты (без посредников)" и "Гостям не нужно приложение"

**Целевое состояние:**
- Полное удаление этих двух пунктов из UI
- Удаление соответствующих ключей из переводов или замена на новые

**Подход:**
- Удалить блок с trust-пунктами из `LandingHeroSection.tsx`
- Или заменить на новые релевантные пункты

### Задача 3: Унификация стилей кнопок

**Текущее состояние:**
- Кнопки используют разные стили: `bg-blue-600 hover:bg-blue-700`
- Компонент Button из shadcn/ui с вариантами: default, destructive, outline, secondary, ghost, link

**Целевое состояние:**
- Все кнопки на лендинге: белый фон по умолчанию, brand blue при hover
- Единый вариант `landing` в buttonVariants

**Реализация:**
```typescript
// src/components/ui/button.tsx - добавить новый вариант
landing: "bg-white text-slate-900 border border-slate-200 shadow-sm hover:bg-blue-600 hover:text-white hover:border-blue-600 focus-visible:ring-blue-600",
```

### Задача 4: Замена Hero-изображения

**Текущее состояние:**
- Hero-секция содержит CSS-компонент dashboard mockup (не изображение)
- Mockup построен на div-элементах с Tailwind классами

**Целевое состояние:**
- Заменить CSS mockup на изображение в стиле shadcn/ui
- Форматы: WebP (основной) + PNG (fallback)
- Размеры: Desktop 1400-1800px, Mobile 800-1000px

**Подход:**
- Создать/получить изображение в стиле shadcn/ui
- Использовать Next.js Image компонент с responsive sizes
- Сохранить в `/public/images/hero/`

## Компоненты и интерфейсы

### Обновление Hero-секции

```typescript
// src/components/landing/main/sections/LandingHeroSection.tsx
// Текущая структура hero-текста:
<motion.h1>
  {t('hero.headlinePrefix')} <span className="italic">{t('hero.headlineItalic')}</span>
  {t('hero.headlineSuffix')} <span className="text-blue-600">{t('hero.headlineHighlight')}</span>
</motion.h1>
<motion.p>{t('hero.subheadline')}</motion.p>

// Целевая структура - упрощённая:
<motion.h1>
  {t('hero.headline')}
</motion.h1>
<motion.p>{t('hero.subheadline')}</motion.p>
```

### Обновление переводов

```json
// messages/ru.json - landingV3.hero
{
  "hero": {
    "badge": "Работает на Бали · 0% комиссия",
    "headline": "Цифровая платформа гостевого опыта, в\u00A0которой люди работают с\u00A0людьми.",
    "subheadline": "Бесплатное подключение. Гостям вашего заведения будет удобнее, а\u00A0персоналу\u00A0— проще.",
    "cta": "Запустить бесплатно за 1 час"
  }
}
```

### Новый вариант кнопки

```typescript
// src/components/ui/button.tsx
const buttonVariants = cva(
  "inline-flex items-center justify-center gap-2 ...",
  {
    variants: {
      variant: {
        // ... существующие варианты
        landing:
          "bg-white text-slate-900 border border-slate-200 shadow-sm hover:bg-blue-600 hover:text-white hover:border-blue-600 transition-colors",
      },
    },
  }
)
```

## Модели данных

Изменения базы данных не требуются. Все изменения касаются только UI и файлов переводов.

## Свойства корректности

*Свойство — это характеристика или поведение, которое должно выполняться во всех допустимых выполнениях системы.*



### Рефлексия свойств

После анализа критериев приёмки, несколько свойств можно консолидировать:

- Свойства 3.1-3.5 о кнопках можно объединить в одно свойство о единообразии стилей кнопок
- Свойства 4.3 и 4.6 об изображении можно объединить
- Примеры 2.1 и 2.2 об удалённых пунктах можно объединить в один тест

### Свойства корректности

**Свойство 1: Неразрывные пробелы в hero-тексте**
*Для любого* hero-текста на русском языке, строка должна содержать символы неразрывного пробела (\u00A0) между предлогами и следующими словами ("в которой", "с людьми", "а персоналу").
**Валидирует: Требование 1.3**

**Свойство 2: Отсутствие удалённых пунктов в данных**
*Для любого* массива trust-пунктов или преимуществ, массив не должен содержать элементы с ключами или текстом "Гостям не нужно приложение" или "Прямые выплаты".
**Валидирует: Требования 2.1, 2.2, 2.4**

**Свойство 3: Единообразие стилей кнопок на лендинге**
*Для любой* кнопки на лендинге, элемент должен иметь CSS классы для белого фона по умолчанию и синего фона при hover, с сохранением контраста текста.
**Валидирует: Требования 3.1, 3.2, 3.3, 3.4**

**Свойство 4: Корректность hero-изображения**
*Для любого* hero-изображения, элемент должен использовать WebP формат с fallback, иметь заданные width/height атрибуты для предотвращения layout shift.
**Валидирует: Требования 4.3, 4.6**

### Примеры тестов

**Пример 1: Hero-текст содержит новое позиционирование**
При загрузке hero-секции, текст должен содержать "платформа гостевого опыта".
**Валидирует: Требования 1.1, 1.2**

**Пример 2: Сборка проходит успешно**
При выполнении `npm run build`, команда должна завершиться с кодом 0.
**Валидирует: Требование 5.1**

**Пример 3: Hero-изображение имеет оптимизированный размер**
Файл hero-изображения должен быть меньше 400KB.
**Валидирует: Требование 4.8**

## Обработка ошибок

### Ошибки переводов

**Отсутствующие ключи:**
- Если ключ перевода не найден, next-intl покажет ключ вместо текста
- Митигация: Проверить все ключи во всех языковых файлах

**Неразрывные пробелы:**
- Некорректное отображение в некоторых шрифтах
- Митигация: Использовать Unicode \u00A0 вместо HTML &nbsp;

### Ошибки кнопок

**Конфликты стилей:**
- Inline стили могут переопределить вариант
- Митигация: Удалить inline className для кнопок, использовать только variant

**Состояния доступности:**
- focus-visible может быть сломан
- Митигация: Тестировать навигацию клавиатурой

### Ошибки изображения

**Отсутствие файла:**
- Next.js Image покажет broken image
- Митигация: Проверить наличие файлов перед деплоем

**Layout shift:**
- Изображение без размеров вызовет CLS
- Митигация: Всегда указывать width/height или использовать fill с контейнером

## Стратегия тестирования

### Unit-тестирование

- Проверка наличия нового текста в hero-секции
- Проверка отсутствия удалённых пунктов
- Проверка CSS классов кнопок
- Проверка атрибутов изображения

### Property-Based тестирование

Используем библиотеку `fast-check` для property-based тестов.

**Конфигурация:**
- Минимум 100 итераций на тест
- Формат тега: `**Feature: landing-page-v2-improvements, Property {number}: {property_text}**`

### Интеграционное тестирование

- `npm run build` проходит без ошибок
- Визуальная проверка в Chrome/Safari (desktop + mobile)
- Проверка hover/focus для кнопок (клавиатура Tab)
- Проверка загрузки изображения (нет layout shift)

## Заметки по реализации

### Порядок изменений

1. Обновить файлы переводов (ru.json, en.json)
2. Обновить LandingHeroSection.tsx - удалить trust-пункты
3. Добавить вариант `landing` в button.tsx
4. Обновить все кнопки на лендинге на variant="landing"
5. Создать/добавить hero-изображение
6. Заменить CSS mockup на Image компонент
7. Запустить тесты и сборку

### Responsive дизайн

**Hero-изображение:**
- Использовать Next.js Image с sizes prop
- `sizes="(max-width: 768px) 100vw, 50vw"`
- Подготовить 2 размера: desktop и mobile

**Кнопки:**
- Стили должны работать на всех размерах экрана
- Проверить touch-состояния на mobile

### Совместимость браузеров

- WebP: поддерживается всеми современными браузерами
- CSS hover: работает на desktop, игнорируется на touch-устройствах
- Неразрывные пробелы: универсальная поддержка

### Производительность

- Hero-изображение: оптимизировать до 250-400KB
- Next.js Image автоматически конвертирует в WebP
- Указать priority для hero-изображения для LCP
