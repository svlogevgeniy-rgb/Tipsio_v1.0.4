# –ü—Ä–æ–≥—Ä–µ—Å—Å —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞

## ‚úÖ –ó–∞–≤–µ—Ä—à–µ–Ω–æ

### –§–∞–∑–∞ 1: –°–æ–∑–¥–∞–Ω–∏–µ –æ–±—â–∏—Ö —É—Ç–∏–ª–∏—Ç –∏ —Ç–∏–ø–æ–≤ (100%)

#### 1.1 –¢–∏–ø—ã –¥–ª—è API ‚úÖ
- **–§–∞–π–ª**: `src/types/api.ts`
- **–°–æ–¥–µ—Ä–∂–∏—Ç**:
  - `ApiErrorCode` - —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ –∫–æ–¥—ã –æ—à–∏–±–æ–∫
  - `ApiErrorResponse` - —Ç–∏–ø–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã —Å –æ—à–∏–±–∫–∞–º–∏
  - `ApiSuccessResponse` - —Ç–∏–ø–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —É—Å–ø–µ—à–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã
  - `SessionUser`, `AppSession`, `ApiContext` - —Ç–∏–ø—ã –¥–ª—è —Å–µ—Å—Å–∏–π
  - `VenueAccessResult` - —Ä–µ–∑—É–ª—å—Ç–∞—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ –¥–æ—Å—Ç—É–ø–∞ –∫ venue

#### 1.2 API middleware —É—Ç–∏–ª–∏—Ç—ã ‚úÖ
- **–§–∞–π–ª**: `src/lib/api/middleware.ts`
- **–§—É–Ω–∫—Ü–∏–∏**:
  - `requireAuth()` - –ø—Ä–æ–≤–µ—Ä–∫–∞ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
  - `requireVenueAccess()` - –ø—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–∞ –∫ venue
  - `requireRole()` - –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ä–æ–ª–µ–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
  - `getVenueIdFromQuery()` - –∏–∑–≤–ª–µ—á–µ–Ω–∏–µ –∏ –≤–∞–ª–∏–¥–∞—Ü–∏—è venueId –∏–∑ query

#### 1.3 –¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–π error handler ‚úÖ
- **–§–∞–π–ª**: `src/lib/api/error-handler.ts`
- **–§—É–Ω–∫—Ü–∏–∏**:
  - `handleApiError()` - –æ–±—Ä–∞–±–æ—Ç–∫–∞ –≤—Å–µ—Ö —Ç–∏–ø–æ–≤ –æ—à–∏–±–æ–∫
  - `validationError()` - —Å–æ–∑–¥–∞–Ω–∏–µ –æ—à–∏–±–∫–∏ –≤–∞–ª–∏–¥–∞—Ü–∏–∏
  - `notFoundError()` - —Å–æ–∑–¥–∞–Ω–∏–µ –æ—à–∏–±–∫–∏ "–Ω–µ –Ω–∞–π–¥–µ–Ω–æ"
  - `successResponse()` - —Å–æ–∑–¥–∞–Ω–∏–µ —É—Å–ø–µ—à–Ω–æ–≥–æ –æ—Ç–≤–µ—Ç–∞

#### 1.4 Fetch —É—Ç–∏–ª–∏—Ç—ã –¥–ª—è –∫–ª–∏–µ–Ω—Ç–∞ ‚úÖ
- **–§–∞–π–ª**: `src/lib/api/client.ts`
- **–°–æ–¥–µ—Ä–∂–∏—Ç**:
  - `ApiError` - –∫–∞—Å—Ç–æ–º–Ω—ã–π –∫–ª–∞—Å—Å –æ—à–∏–±–æ–∫
  - `apiGet()`, `apiPost()`, `apiPut()`, `apiPatch()`, `apiDelete()` - —Ç–∏–ø–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã
  - `buildUrl()` - –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ URL —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏

#### 1.5 –•—É–∫–∏ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º ‚úÖ
- **–§–∞–π–ª**: `src/hooks/use-session-storage.ts`
  - `useSessionStorage()` - —Ö—É–∫ –¥–ª—è –æ–¥–Ω–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è
  - `useSessionStorageGroup()` - —Ö—É–∫ –¥–ª—è –≥—Ä—É–ø–ø—ã —Å–≤—è–∑–∞–Ω–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π
  
- **–§–∞–π–ª**: `src/hooks/use-api.ts`
  - `useApiState()` - —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º API –∑–∞–ø—Ä–æ—Å–æ–≤
  - `executeApiCall()` - –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ API –≤—ã–∑–æ–≤–æ–≤ —Å –æ–±—Ä–∞–±–æ—Ç–∫–æ–π –æ—à–∏–±–æ–∫
  - `useApiMutation()` - —Ö—É–∫ –¥–ª—è –º—É—Ç–∞—Ü–∏–π (POST, PUT, PATCH, DELETE)

- **–§–∞–π–ª**: `src/hooks/use-optimistic-update.ts`
  - `useOptimisticUpdate()` - –æ–ø—Ç–∏–º–∏—Å—Ç–∏—á–Ω—ã–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å –æ—Ç–∫–∞—Ç–æ–º

#### 1.6 –ò–Ω–¥–µ–∫—Å–Ω—ã–π —Ñ–∞–π–ª –¥–ª—è —ç–∫—Å–ø–æ—Ä—Ç–∞ ‚úÖ
- **–§–∞–π–ª**: `src/lib/api/index.ts`
- –¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–π —ç–∫—Å–ø–æ—Ä—Ç –≤—Å–µ—Ö API —É—Ç–∏–ª–∏—Ç

### –§–∞–∑–∞ 2: –†–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ API —Ä–æ—É—Ç–æ–≤ (10%)

#### –†–µ—Ñ–∞–∫—Ç–æ—Ä–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã:
1. ‚úÖ `src/app/api/staff/route.ts`
   - –ò—Å–ø–æ–ª—å–∑—É–µ—Ç `requireAuth()`, `requireVenueAccess()`, `getVenueIdFromQuery()`
   - –ò—Å–ø–æ–ª—å–∑—É–µ—Ç `handleApiError()`, `validationError()`, `successResponse()`
   - –ö–æ–¥ —Å–æ–∫—Ä–∞—Ç–∏–ª—Å—è —Å 240 —Å—Ç—Ä–æ–∫ –¥–æ 200 —Å—Ç—Ä–æ–∫
   - –£–±—Ä–∞–Ω–æ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–≤–µ—Ä–æ–∫ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∏ –¥–æ—Å—Ç—É–ø–∞

2. ‚úÖ `src/app/api/qr/route.ts`
   - –ò—Å–ø–æ–ª—å–∑—É–µ—Ç –Ω–æ–≤—ã–µ middleware —É—Ç–∏–ª–∏—Ç—ã
   - –ö–æ–¥ —Å–æ–∫—Ä–∞—Ç–∏–ª—Å—è —Å 160 —Å—Ç—Ä–æ–∫ –¥–æ 110 —Å—Ç—Ä–æ–∫
   - –£–ª—É—á—à–µ–Ω–∞ —á–∏—Ç–∞–µ–º–æ—Å—Ç—å –∏ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞

3. ‚úÖ `src/app/api/menu/categories/route.ts`
   - –ü–æ–ª–Ω–æ—Å—Ç—å—é —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–µ–Ω —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –Ω–æ–≤—ã—Ö —É—Ç–∏–ª–∏—Ç
   - –ö–æ–¥ —Å–æ–∫—Ä–∞—Ç–∏–ª—Å—è —Å 120 —Å—Ç—Ä–æ–∫ –¥–æ 70 —Å—Ç—Ä–æ–∫
   - –£–±—Ä–∞–Ω–æ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ

### –§–∞–∑–∞ 3: –†–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ —Ö—É–∫–æ–≤ (30%)

#### –†–µ—Ñ–∞–∫—Ç–æ—Ä–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã:
1. ‚úÖ `src/components/venue/register/use-persisted-register.ts`
   - –ò—Å–ø–æ–ª—å–∑—É–µ—Ç `useSessionStorageGroup()`
   - –ö–æ–¥ —Å–æ–∫—Ä–∞—Ç–∏–ª—Å—è —Å 80 —Å—Ç—Ä–æ–∫ –¥–æ 35 —Å—Ç—Ä–æ–∫
   - –£–±—Ä–∞–Ω–æ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –ª–æ–≥–∏–∫–∏ sessionStorage

## üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞

### –°–æ–∑–¥–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã:
- `src/types/api.ts` (60 —Å—Ç—Ä–æ–∫)
- `src/lib/api/middleware.ts` (120 —Å—Ç—Ä–æ–∫)
- `src/lib/api/error-handler.ts` (70 —Å—Ç—Ä–æ–∫)
- `src/lib/api/client.ts` (110 —Å—Ç—Ä–æ–∫)
- `src/lib/api/index.ts` (7 —Å—Ç—Ä–æ–∫)
- `src/hooks/use-session-storage.ts` (120 —Å—Ç—Ä–æ–∫)
- `src/hooks/use-api.ts` (90 —Å—Ç—Ä–æ–∫)
- `src/hooks/use-optimistic-update.ts` (55 —Å—Ç—Ä–æ–∫)

**–ò—Ç–æ–≥–æ**: 8 –Ω–æ–≤—ã—Ö —Ñ–∞–π–ª–æ–≤, ~630 —Å—Ç—Ä–æ–∫ –ø–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º–æ–≥–æ –∫–æ–¥–∞

### –†–µ—Ñ–∞–∫—Ç–æ—Ä–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã:
- 3 API —Ä–æ—É—Ç–∞ (—Å–æ–∫—Ä–∞—â–µ–Ω–∏–µ –Ω–∞ ~150 —Å—Ç—Ä–æ–∫)
- 1 —Ö—É–∫ (—Å–æ–∫—Ä–∞—â–µ–Ω–∏–µ –Ω–∞ ~45 —Å—Ç—Ä–æ–∫)

**–≠–∫–æ–Ω–æ–º–∏—è**: ~195 —Å—Ç—Ä–æ–∫ –∫–æ–¥–∞

### –ü—Ä–æ–≤–µ—Ä–∫–∏:
- ‚úÖ –°–±–æ—Ä–∫–∞ –ø—Ä–æ–µ–∫—Ç–∞: —É—Å–ø–µ—à–Ω–∞
- ‚úÖ –õ–∏–Ω—Ç–µ—Ä: –±–µ–∑ –æ—à–∏–±–æ–∫
- ‚úÖ –¢–µ—Å—Ç—ã: 89/89 –ø—Ä–æ–π–¥–µ–Ω–æ
- ‚úÖ TypeScript: –±–µ–∑ –æ—à–∏–±–æ–∫ —Ç–∏–ø–∏–∑–∞—Ü–∏–∏

## üéØ –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

### –§–∞–∑–∞ 2: –ü—Ä–æ–¥–æ–ª–∂–µ–Ω–∏–µ —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞ API —Ä–æ—É—Ç–æ–≤ (~35 —Ñ–∞–π–ª–æ–≤)
–ü—Ä–∏–º–µ–Ω–∏—Ç—å –Ω–æ–≤—ã–µ —É—Ç–∏–ª–∏—Ç—ã –∫ –æ—Å—Ç–∞–≤—à–∏–º—Å—è API —Ä–æ—É—Ç–∞–º:
- `/api/menu/items/route.ts`
- `/api/menu/items/[id]/route.ts`
- `/api/menu/categories/[id]/route.ts`
- `/api/venues/[id]/route.ts`
- `/api/staff/[id]/route.ts`
- –ò –¥—Ä—É–≥–∏–µ (~30 —Ñ–∞–π–ª–æ–≤)

### –§–∞–∑–∞ 3: –ü—Ä–æ–¥–æ–ª–∂–µ–Ω–∏–µ —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞ —Ö—É–∫–æ–≤
- `useVenueMenu` - –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `useOptimisticUpdate()`
- `useStaffManagement` - –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `useApiMutation()`

### –§–∞–∑–∞ 4: –ö–æ–Ω—Å–æ–ª–∏–¥–∞—Ü–∏—è —Å—Ö–µ–º –≤–∞–ª–∏–¥–∞—Ü–∏–∏
- –°–æ–∑–¥–∞—Ç—å `src/lib/schemas/` –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é
- –†–∞–∑–¥–µ–ª–∏—Ç—å —Å—Ö–µ–º—ã –ø–æ –¥–æ–º–µ–Ω–∞–º

### –§–∞–∑–∞ 5: –û—á–∏—Å—Ç–∫–∞ —É—Å—Ç–∞—Ä–µ–≤—à–∏—Ö —Ñ–∞–π–ª–æ–≤
- –£–¥–∞–ª–∏—Ç—å `page-old.tsx`, `page-dark.tsx`
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å `landing/legacy/`

### –§–∞–∑–∞ 6: –£–ª—É—á—à–µ–Ω–∏–µ middleware
- –í—ã–Ω–µ—Å—Ç–∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é —Ä–æ—É—Ç–æ–≤ –≤ –æ—Ç–¥–µ–ª—å–Ω—ã–π —Ñ–∞–π–ª

## üí° –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞

1. **–°–æ–∫—Ä–∞—â–µ–Ω–∏–µ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è**: –ü–æ–≤—Ç–æ—Ä—è—é—â–∏–π—Å—è –∫–æ–¥ –≤—ã–Ω–µ—Å–µ–Ω –≤ –ø–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ —É—Ç–∏–ª–∏—Ç—ã
2. **–£–ª—É—á—à–µ–Ω–Ω–∞—è —Ç–∏–ø–∏–∑–∞—Ü–∏—è**: –í—Å–µ API –æ—Ç–≤–µ—Ç—ã –∏ –æ—à–∏–±–∫–∏ —Ç–∏–ø–∏–∑–∏—Ä–æ–≤–∞–Ω—ã
3. **–ï–¥–∏–Ω–æ–æ–±—Ä–∞–∑–∏–µ**: –í—Å–µ API —Ä–æ—É—Ç—ã —Å–ª–µ–¥—É—é—Ç –æ–¥–Ω–æ–º—É –ø–∞—Ç—Ç–µ—Ä–Ω—É
4. **–£–ø—Ä–æ—â–µ–Ω–∏–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è**: –£—Ç–∏–ª–∏—Ç—ã –º–æ–∂–Ω–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –æ—Ç–¥–µ–ª—å–Ω–æ
5. **–õ–µ–≥–∫–æ—Å—Ç—å –ø–æ–¥–¥–µ—Ä–∂–∫–∏**: –ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ –æ–¥–Ω–æ–º –º–µ—Å—Ç–µ –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è –≤–µ–∑–¥–µ
6. **–õ—É—á—à–∞—è —á–∏—Ç–∞–µ–º–æ—Å—Ç—å**: –ö–æ–¥ —Å—Ç–∞–ª –∫–æ—Ä–æ—á–µ –∏ –ø–æ–Ω—è—Ç–Ω–µ–µ
